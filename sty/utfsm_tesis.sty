% ---------------------------------------------------------------------------------------------------------------
% Modificado de:
%-% Estilo de Tesis de la Universidad Técnica Federico Santa María
%-% Departamento de Informática.
%-% Valparaíso, Chile
%-% Last edit: 05 Octubre 2012
%-% Last edit by: Felipe Calderón Baeza
%
% Modificado de:
%-% Estilo de Tesis de la Universidad Técnica Federico Santa María
%-% Departamento de Informática.
%-% Last edit: 28 Junio 2010
%-% Last edit by: Diego Candel Contardo
%
% Modificado de:
%-% Universidad Técnica Federico Santa María - Estilo de Tesis
%-% Departamento de Informática
%-% Last edit: 4 Julio 2002
%-% Last edit by: Romina Torres y Rodrigo Salas Fuentes
%
% Modificado de:
%-% Dalhousie University thesis style
%-% Dept. of Math. Stats. and Comp. Sci.
%
% Modificado de:
%-% Stanford University PhD thesis style -- modifications to the report style
%-% For LaTeX version 2.09
%-% Last edit: Tue Sep 13 14:40:26 1988
%-% Last edit by: Joseph Pallas
% ---------------------------------------------------------------------------------------------------------------
\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{sty/utfsm_tesis}[2010] % Estilo de Tesis de la UTFSM.
\typeout{Tesis Info Style}
\RequirePackage{ifthen}
\RequirePackage{latexsym}
\RequirePackage{tabularx}
\typeout{Opciones de Estilo del Documento 'UTFSM_tesis'.}

\long\def\comment#1{}
\comment{
  Ejemplo del Modo de Uso:
    \documentstyle[12pt,UTFSM_Tesis]{report}
    \begin{document}
    \title{Como escribir una Tesis\\
        con dos líneas en los Títulos}
    \author{Rodrigo Salas}

    \profguia{Profesor Guía}		% Cambiado a partir de supervisor.
    \profcorr{Profesor Correferente}	% Cambiado a partir de firstreader.
    \profext{Profesor Externo}		% Cambiado a partir de secondreader.

    \dedicate{
    Esta parte es opcional\\
    Página de dedicación.\\
    }

    \beforepreface
    \prefacesection{Abstract}
    Un resumen es requerido en todas las Tesis. Asegurarse que alcance en una página!.

    \afterpreface

    \chapter{Introducción}
     ...
    \chapter{Conclusiones}
     ...
    \appendix
    \chapter{Demostraciones}
     ...
    \bibliographystyle{plain}
    \bibliography{mybib}
    \end{document}

Documentación:

	Este archivo de estilo modifica el estilo de reporte estándar para respetar las 
	"regulaciones para la submisión de Tesis" de la escuela de graduados de la 
	Universidad Técnica Federico Santa María. Coloca los márgenes y el interlineado 
	requerido e inhabilita los saltos de páginas y 'hypens'.
	
	El comando \beforepreface crea la página de título, la página de firmas y la página 
	de permisos (opcionalmente). Por lo tanto, el usuario debería colocar la sección de 
	prefacio usando el comando \prefacesection{section title}. El comando \afterpreface 
	produce las tablas de contenidos, tablas y figuras (opcionalmente), y coloca las 
	cosas al comienzo del cuerpo principal (en la página 1 con número arábigo).

Los siguientes comandos controlan el typesetting de tu Tesis:

   Información Básica:

    \title{Título de Tesis}
        - Aparecerá grande en la página i. Si es demasiado grande se separará
        automáticamente en líneas diferentes. Para especificar un salto de línea
        usar el comando \\ dentro del título.
        \title{Very Long\\Title\\Split Over\\Several Lines}
        Asegurarse que no exista espacio antes de \\.
    \author{Nombre del autor}
        - Tu nombre (idealmente completo) como deseas que aparezca en tu Tesis.

   Información de Graduación y Submisión:

    \submitdate{Mes y Año en la cual se entregó a la Escuela de Graduados}
        - Fecha LaTeX si se omite.
    \copyrightyear{Año de la Tesis}
        - Año del LaTeX si se omite.
    \convocation{Mes}{Año}
        - Fecha de convocatoria.

   Especificación del Grado:

    \msc
        - Grado a obtener es Master of Science, M.Sc.
    \ma
        - Grado a obtener es Master of Arts, M.A.
    \phd
        - Grado a obtener es Doctor of Philosophy, Ph.D.
    \ingej
        - Grado a obtener es Ingeniero Ejecución, Ing.Ej.
    \ingciv
        - Grado a obtener es Ingeniero Civil, Ing.Civ. (por defecto).
    \magister
        - Grado a obtener es Magister, Mg.
    \doctor
        - Grado a obtener es Doctor, Dr.

   Firmas de Profesores:

    \profguia{Nombre del Profesor Guía}
        - Incluye nombre del Profesor Guía del Investigador.
    \profcorr{Nombre del Profesor Correferente}
        - Incluye el nombre del Profesor Correferente.
    \profext{Nombre del Profesor Externo}
        - Incluye el nombre del Profesor Externo (Sólo para Magister y Doctor).

   Comandos de Seccionamiento:

    \dedicate{
      Primera línea\\
      Segunda línea\\
      Última línea.
    }
        - Produce la página opcional de dedicación. Se debe colocar antes
        del comando \beforepreface. No dejar espacio antes de \\.
    \prefacesection{Nombre o Título de Sección de Prefacio}
    Blah, blah, blah...
        - Produce una sección de prefacio como el Resumen, Reconocimientos, etc.
        Debe aparecer entre los comandos \beforepreface y \afterpreface.
        El Typeset es similar a los capítulos y no está numerado.
    \chapter{Nombre del Capítulo}
    Blah, blah, blah...
        - Produce una sección de capítulo enumerada.
    \section{Nombre de la Sección}
        - Colocado después del capítulo. Produce una sección enumerada
        jerárquicamente.
    \subsection{Nombre de la Sub-sección}
        - Colocado después de una sección. Produce una sub-sección enumerada
        jerárquicamente.
    \appendix
        - Colocar este comando antes del primer capítulo apéndice.
          Usar el comando \chapter.  Será indexado con letra y no
          con número en el índice de contenidos.
    \nonumchapter{Cualquier cosa}
    Blah, blah, blah...
        - Produce una sección de capítulo que no está numerado,
          como por ejemplo la Introducción. Se utiliza de la
          misma manera que el comando \chapter.

   Imprimiendo Copias Draft:

    \draft
        - Para imprimir copias draft de la tesis. Especifica en la
        cabecera que la copia es un draft y la fecha de impresión.
        También especifica el draft y la fecha en la página título.
    \nofront
        - Especifica no imprimir las páginas de firmas,tablas de contenidos, 
        y la lista de las figuras y tablas.
        Útil para las copias de borrador para disminuir la impresión.
    \nobib
        - Suprime la impresión de la bibliografía.
        Útil para las copias borrador para disminuir la impresión.

   Comandos Especializados:

    \nolistoffigures
        - No produce la lista de las figuras.
    \nolistoftables
        - No produce la lista de las tablas.
    \twosupervisors
        - Utilizar cuando se tiene dos supervisores en vez de uno.
          Nombre dado por \profguia{} va primero, \profcorr{}
          va segundo. Puede ir con el formato de Ph.D.
    \university{Nombre de la Universidad}
        - "Universidad Técnica Federico Santa María" por defecto.  Se puede
        usar salto de línea de ser necesario.
    \address{Dirección de la Universidad}
        - "Av. España 1680, Valparaíso" por defecto.
    \dept{Departamento del Autor}
        - "Informática" por defecto.
    \faculty{Grado que otorga la Facultad}
        - [Facultad de] "Graduados" por defecto.
    \degree{Título completo del grado}
    \degreeinitial{F.D.T.}
        - Especifica el nombre del grado e iniciales.
          \degree{Master of Business Administration}
          \degreeinitial{M.B.A.}

Este estilo utiliza interlineado que es 1.37 veces lo normal, excepto
en los ambientes de figuras y tablas donde se utiliza un interlineado normal.
Se puede cambiar al hacer:
    \renewcommand{\baselinestretch}{1.5}
(o cualquier número que se desee en vez del parámetro 1.5)

Desafortunadamente, probablemente el comando no tenga efecto al menos que esté antes que
\begin{document} o después del comando de cambio del tamaño de la letra, como por ejemplo
\small or \normalsize.

El ejemplo de arriba muestra 12pt substyle siendo utilizado. Esto es requerido
para entregar una copia, pero se puede omitir para imprimir un borrador más pequeño.
Notar que el material del front puede no verse bien en una copia pequeña.
}
% ---------------------------------------------------------------------------------------------------------------

% Define la cabecera de la página para enumerarla solamente.
\newcommand{\properpagestyle}{
       \pagestyle{plain}}

% Lo primero que se hace es ver si el reporte ha sido cargado.
% Un error común es tratar de usar "suthesis" como un documentstyle.
\@ifundefined{chapter}{\@latexerr{La opción de `UTFSM_Tesis' debería ser usado
con el estilo de documento `report'}{Usted debería leer la documentación de UTFSM_Tesis.}}{}

% Se necesita un margen de 1" excepto en la página de binding la cual es de 1 1/2"
% Las Tesis son por un lado, por lo tanto no nos preocupamos por \evensidemargin
\oddsidemargin 0.5in \evensidemargin 0in
\marginparwidth 40pt \marginparsep 10pt
\topmargin 0pt \headsep .5in
\textheight 8.1in \textwidth 6in

% No permitir salto de páginas en hyphens (esto dará algunos underfull vbox's,
% entonces una alternativa es usar \brokenpenalty=100 y manualmente buscar
% y arreglar tales saltos de páginas).
\brokenpenalty=10000

% Usar 1.37 veces el salto baseline-to-baseline normal
\renewcommand{\baselinestretch}{1.37}

% Redefinir los macros de los pie de páginas para usar interlineado simple.
\long\def\@footnotetext#1{\insert\footins{\def\baselinestretch{1}\footnotesize
    \interlinepenalty\interfootnotelinepenalty
    \splittopskip\footnotesep
    \splitmaxdepth \dp\strutbox \floatingpenalty \@MM
    \hsize\columnwidth \@parboxrestore
   \edef\@currentlabel{\csname p@footnote\endcsname\@thefnmark}\@makefntext
    {\rule{\z@}{\footnotesep}\ignorespaces
      #1\strut}}
}

% \author y \title son definidos en el reporte directamente; aquí está el resto de los
% front que definen macros.
\def\university#1{\gdef\@university{#1}}
\def\address#1{\gdef\@address{#1}}
\def\dept#1{\gdef\@dept{#1}}
\def\faculty#1{\gdef\@faculty{#1}}
\def\profguia#1{\gdef\@profguia{#1}}
\def\profcorr#1{\gdef\@profcorr{#1}}
\def\profext#1{\gdef\@profext{#1}}
\def\twosupervisors{\two@supervisorstrue}
\def\ack#1{\gdef\@ack{#1}}
\def\resumenesp#1{\gdef\@resumenesp{#1}}
\def\resumening#1{\gdef\@resumening{#1}}
\def\abreviaciones#1{\gdef\@abreviaciones{#1}}
\def\submitdate#1{\gdef\@submitdate{#1}}
\def\copyrightyear#1{\gdef\@copyrightyear{#1}}
\def\degree#1{\gdef\@degree{#1}}
\def\degreeinitial#1{\gdef\@degreeinitial{#1}}
\def\msc{\degree{Master of Science}\degreeinitial{M.Sc.}}
\def\phd{\degree{Doctor of Philosophy}\degreeinitial{Ph.D.}\ph@dtrue}
\def\ma{\degree{Master of Arts}\degreeinitial{M.A.}}
\def\ingej{\degree{Ingeniero en Ejecución}\degreeinitial{Ing.Ej.}}
\def\ingciv{\degree{Ingeniero Civil}\degreeinitial{Ing.Civ.}}
\ingciv % Grado por defecto.
\def\mention#1{\menti@ntrue\gdef\themention@text{#1}}
\def\magister{\degree{Magíster en Ciencias de la Ingeniería Informática}\degreeinitial{Mg.}\ph@dtrue}
\def\doctor{\degre{Doctor}\degreeinitial{Dr.}\ph@dtrue}
\def\@title{}
\def\@author{}
\def\@university{Universidad Técnica Federico Santa María}
\def\@address{Av. España 1680, Valparaíso}
\def\@dept{Informática}
\def\@faculty{Graduados}
\def\@profguia{}\def\@profcorr{}\def\@profext{}
\def\@submitdate{\ifcase\the\month\or
  Enero\or Febrero\or Marzo\or Abril\or Mayo\or Junio\or
  Julio\or Agosto\or Septiembre\or Octubre\or Noviembre\or Diciembre\fi
  \space \number\the\year}
\def\@copyrightyear{\number\the\year}
\def\convocation#1#2{\gdef\@convocationmonth{#1}\gdef\@convocationyear{#2}}
\def\@convwarn{\typeout{Alerta: El día de la convocatoria puede estar incorrecto!}}
\def\dedicate#1{\dedic@tiontrue\gdef\dedication@text{#1}}
\def\draft{\renewcommand{\properpagestyle}{\pagestyle{myheadings}
\markright{{\rm Versión Borrador -- \today}}}\draft@modetrue\properpagestyle}
\def\nobib{\print@bibfalse}
\def\nolistoffigures{\figurespagefalse}
\def\nolistoftables{\tablespagefalse}
\def\nofront{\front@pagesfalse\figurespagefalse\tablespagefalse}

% Contructores (si no existe):	Valores por defecto:
\newif\iffigurespage		\figurespagetrue
\newif\iftablespage			\tablespagetrue
\newif\iffront@pages		\front@pagestrue
\newif\ifthird@reader		\third@readerfalse
\newif\iffourth@reader		\fourth@readerfalse
\newif\iffifth@reader		\fifth@readerfalse
\newif\ifph@d			\ph@dfalse
\newif\iftwo@supervisors		\two@supervisorsfalse
\newif\ifdraft@mode		\draft@modefalse
\newif\ifprint@bib			\print@bibtrue
\newif\ifdedic@tion			\dedic@tionfalse
\newif\ifmenti@n			\menti@nfalse
% Inhabilita saltos de linea explícitos.
\def\no@breaks#1{{\def\\{ \ignorespaces}#1}}

% Portada de la Tesis, incluyendo el formato apropiado.
\def\titlep{
    \thispagestyle{empty}
    \begin{center}
        \large\textsc{\expandafter{\@university} \\
        Departamento de \expandafter{\@dept} \\
        Valparaíso -- Chile}
      \vskip0.1in  
        \epsfig{file=logo_usm_big,width=140pt}
    \end{center}
      \vskip0.3in  
    \begin{center}
        \hyphenpenalty=10000\large \textbf{\uppercase\expandafter{\@title}}
    \end{center}
      \vskip0.2in
    \begin{center}
        \large \uppercase\expandafter{\@author}
        \vskip0.2in
        \large\rm \textsc{MEMORIA PARA OPTAR AL T\'ITULO DE}  \\
        \large \textsc{INGENIERO CIVIL INFORMÁTICO}
    \end{center}
    \begin{center}
        \vskip 0.6in
        \normalsize{PROFESORA GUÍA:}\\
        \textsc\expandafter{\@profguia}\\
      \vskip0.1in
        \normalsize{PROFESOR CORREFERENTE:}\\
        \textsc\expandafter{\@profcorr}\\
        \vskip 0.6in
        \normalsize\uppercase\expandafter{\@convocationmonth}
        \normalsize\textsc\expandafter{\@convocationyear}
    \end{center}
    \vfill
    \setcounter{page}{1}
    % Página en blanco.
	%\newpage \thispagestyle{empty}\begin{flushright}\vfill\end{flushright}
    % Comienza el contador numérico romano.
	%\newpage \setcounter{page}{2}\begin{flushright}\vfill\end{flushright}
}
\def\signature#1#2{
	\parbox[b]{1in}{\smash{#1}\vskip12pt}
	\hfill \parbox[t]{3in}{\shortstack{\vrule width 3in height 0.4pt\\\small#2}}
}

\def\beforepreface{
\typeout{Most over/underfulls in first few pages are the fault of dalthesis.}
\typeout{Ignore all them. If uncorrectable errors occur, notify staff.}

    \pagenumbering{roman}
    \pagestyle{plain}
    \titlep
    \iffront@pages
        %\addtocounter{page}{1}
        \iffront@pages\ifdedic@tion
            \begin{flushright}
            \ \vskip5in
            \Large\em\null\vskip1in
            \dedication@text
            \end{flushright}
            \newpage
            \typeout{Agradecimientos}
            \include{\@ack}
        \fi
    \fi
    {
    \typeout{Resumen}
    \include{\@resumenesp}
    }
    {
    \typeout{Abstract}
    \include{\@resumening}
    }
    \iffront@pages\tableofcontents\else\addtocounter{page}{1}\fi
    \newpage
    \iftablespage
        \addcontentsline{toc}{chapter}{\'Indice de Tablas}\listoftables
        \newpage
    \fi
    \iffigurespage
        \addcontentsline{toc}{chapter}{\'Indice de Figuras}\listoffigures
        \newpage
    \fi
    {\typeout{Abreviaciones}
     \include{\@abreviaciones}
     }
}

\def\nonumchapter#1{
    \chapter*{#1}
    \addcontentsline{toc}{chapter}{#1}}
\def\prefacesection#1{
    \chapter*{#1}
    \addcontentsline{toc}{chapter}{#1}}


\newenvironment{dedication}{\newpage\begin{center}\Large\em\null\vskip1in}
{\vfill\end{center}}

\def\afterpreface{\newpage
    \pagenumbering{arabic}
    \pagestyle{plain}
    \typeout{Las páginas del prefacio de la UTFSM_Tesis han sido escritas}
    \properpagestyle}

% Redefine \thebibliography para ir a una nueva página y colocar la entrada en la
% tabla de contenidos (toc).
\let\@ldthebibliography\thebibliography
\renewcommand{\thebibliography}[1]{%
    \newpage
    \addcontentsline{toc}{chapter}{Bibliograf\'ia}
    \@ldthebibliography{#1}
}
\let\@ldbibliography\bibliography
\renewcommand{\bibliography}[1]{\ifprint@bib\@ldbibliography{#1}\fi}

% Comenzar Normal.
\properpagestyle

% Agregamos traducción adecuada y coherente con el estilo, sobreescribiendo la original.
\addto\captionsspanish{
    \def\figurename{Figura}
    \def\listfigurename{\'Indice de Figuras}
    \def\tablename{Tabla}
    \def\listtablename{\'Indice de Tablas}
}